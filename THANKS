I am indebted to: 

Mark Moseley: the initial port from 1.8 to 1.9
Martin Davis: how to extend into Array classes and set options from there
